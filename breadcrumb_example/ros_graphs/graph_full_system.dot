digraph ROS2Graph {
  rankdir=LR;
  node [shape=box];

  subgraph cluster__cartpole_ui {
    label="/cartpole_ui";
    style=filled;
    fillcolor=lightgrey;

    "/cartpole_ui" [label="/cartpole_ui\n(breadcrumb_example)", style=filled, fillcolor=lightblue];
    "/cartpole/safety_controller/emergency_stop" [label="/cartpole/safety_controller/emergency_stop\n[std_msgs/msg/Bool]", shape=ellipse, style=filled, fillcolor=lightgreen];
    "/cartpole/bumper/emergency_stop" [label="/cartpole/bumper/emergency_stop\n[std_msgs/msg/Bool]", shape=ellipse, style=filled, fillcolor=lightgreen];
  }

  subgraph cluster__control_cartpole_controller {
    label="/control/cartpole_controller";
    style=filled;
    fillcolor=lightgrey;

    "/control/cartpole_controller" [label="/control/cartpole_controller\n(breadcrumb_example)", style=filled, fillcolor=lightblue];
    "/status/cartpole" [label="/status/cartpole\n[std_msgs/msg/String]", shape=ellipse, style=filled, fillcolor=lightgreen];
    "/hardware/request/force" [label="/hardware/request/force\n[std_msgs/msg/Float64]", shape=ellipse, style=filled, fillcolor=lightgreen];
    "/control/enable" [label="/control/enable\n[std_srvs/srv/SetBool]", shape=diamond, style=filled, fillcolor=lightyellow];
    "/control/track_position" [label="/control/track_position\n[breadcrumb_example_interfaces/action/TrackPosition]", shape=hexagon, style=filled, fillcolor=lightcoral];
  }

  subgraph cluster__hardware_robot_state_publisher {
    label="/hardware/robot_state_publisher";
    style=filled;
    fillcolor=lightgrey;

    "/hardware/robot_state_publisher" [label="/hardware/robot_state_publisher\n(robot_state_publisher)", style=filled, fillcolor=lightblue];
    "/hardware/robot_description" [label="/hardware/robot_description\n[std_msgs/msg/String]", shape=ellipse, style=filled, fillcolor=lightgreen];
  }

  subgraph cluster__hardware_cartpole_simulator {
    label="/hardware/cartpole_simulator";
    style=filled;
    fillcolor=lightgrey;

    "/hardware/cartpole_simulator" [label="/hardware/cartpole_simulator\n(breadcrumb_example)", style=filled, fillcolor=lightblue];
    "/hardware/joint_states" [label="/hardware/joint_states\n[sensor_msgs/msg/JointState]", shape=ellipse, style=filled, fillcolor=lightgreen];
    "/hardware/reset" [label="/hardware/reset\n[std_srvs/srv/Trigger]", shape=diamond, style=filled, fillcolor=lightyellow];
  }

  subgraph cluster__rviz2 {
    label="/rviz2";
    style=filled;
    fillcolor=lightgrey;

    "/rviz2" [label="/rviz2\n(rviz2)", style=filled, fillcolor=lightblue];
  }

  // Topic Edges
  "/cartpole_ui" -> "/cartpole/safety_controller/emergency_stop" [label="publishes"];
  "/cartpole/safety_controller/emergency_stop" -> "/control/cartpole_controller" [label="subscribed by"];
  "/cartpole_ui" -> "/cartpole/bumper/emergency_stop" [label="publishes"];
  "/cartpole/bumper/emergency_stop" -> "/control/cartpole_controller" [label="subscribed by"];
  "/hardware/cartpole_simulator" -> "/hardware/joint_states" [label="publishes (INCOMPATIBLE QOS)", color=orange, style=bold];
  "/hardware/joint_states" -> "/cartpole_ui" [label="subscribed by"];
  "/hardware/joint_states" -> "/cartpole_ui" [label="subscribed by (INCOMPATIBLE QOS)", color=orange, style=bold];
  "/hardware/joint_states" -> "/control/cartpole_controller" [label="subscribed by"];
  "/hardware/joint_states" -> "/hardware/robot_state_publisher" [label="subscribed by"];
  "/control/cartpole_controller" -> "/status/cartpole" [label="publishes"];
  "/status/cartpole" -> "/cartpole_ui" [label="subscribed by"];
  "/control/cartpole_controller" -> "/hardware/request/force" [label="publishes"];
  "/hardware/request/force" -> "/hardware/cartpole_simulator" [label="subscribed by"];
  "/hardware/robot_state_publisher" -> "/hardware/robot_description" [label="publishes"];

  // Service Edges
  "/control/enable" -> "/control/cartpole_controller" [label="provided by", style=dashed];
  "/cartpole_ui" -> "/control/enable" [label="calls", style=dashed];
  "/hardware/reset" -> "/hardware/cartpole_simulator" [label="provided by", style=dashed];
  "/cartpole_ui" -> "/hardware/reset" [label="calls", style=dashed];

  // Action Edges
  "/control/track_position" -> "/control/cartpole_controller" [label="served by", style=dotted];
  "/cartpole_ui" -> "/control/track_position" [label="calls", style=dotted];
}
